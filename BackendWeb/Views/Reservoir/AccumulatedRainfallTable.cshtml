@using DBClassLibrary.UserDataAccessLayer;
@using DBClassLibrary.UserDomainLayer.ReservoirModel;
@using DBClassLibrary.UserDomainLayer.UserInterfaceModel
@{
    var UIReservoirList = ViewBag.UIReservoirList;
    var type = ViewBag.type;
}

@section header{
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
    <link href="https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css"
          rel="stylesheet">
    <link href="~/JSLib/datepicker-master/datepicker.css" rel="stylesheet" />
    <link href="~/SCSS/Views/Reservoir/DataTable/PageStyle.min.css?@DateTime.Now.Ticks" rel="stylesheet" />
}

<div class="page-body">
    <div class="container-xl">
        <div class="row row-cards">
            <!--PageContent-->
            <!--設定-->
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">

                        <!--
                        <div class="d-flex align-items-center font-weight-bold">
                            <h3 class="card-title">設定</h3>
                        </div>
                        -->

                        <div class="row g-2 align-items-center mb-3">

                            <div class="col-12 col-xl-1 w-auto font-weight-bold">水庫</div>
                            <div class="col-12 col-xl-2 ">
                                <select id="ReservoirSelection" class="form-select">
                                    @foreach (SelectOption option in UIReservoirList)
                                    {
                                        <option value="@option.Value">@option.Name</option>
                                    }
                                </select>
                            </div>
                            <div class="col-12 col-xl-1 w-auto font-weight-bold">統計日期</div>
                            <div class="col-12 col-xl-6 col-sm-4 col-md-2 col-xl">
                                <div id="DateTimeSelectionPart" class="option">

                                    @if ((DataType)type != DataType.EffectiveStorage)
                                    {
                                        @*<div class="cbk-elem">
                                                <input checked class="inp-cbx" id="DateTimeSelect" type="radio" name="QuerySelect" style="display: none;" value="IrrgPlanData" label="自行設定">
                                                <label class="cbx" for="DateTimeSelect">
                                                    <span>
                                                        <svg width="12px" height="10px" viewBox="0 0 12 10">
                                                            <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                                                        </svg>
                                                    </span>
                                                </label>
                                            </div>*@
                                    }

                                    @*<h4 class="sub-title">
                                            @((DataType)type == DataType.EffectiveStorage ? "選擇日期" : "開始日期")
                                        </h4>*@
                                    <div class="input-icon">
                                        <input class="form-control" placeholder="Select a date" id="StartDate">
                                        <span class="input-icon-addon">
                                            <!-- Download SVG icon from http://tabler-icons.io/i/calendar -->
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><rect x="4" y="5" width="16" height="16" rx="2"></rect><line x1="16" y1="3" x2="16" y2="7"></line><line x1="8" y1="3" x2="8" y2="7"></line><line x1="4" y1="11" x2="20" y2="11"></line><line x1="11" y1="15" x2="12" y2="15"></line><line x1="12" y1="15" x2="12" y2="18"></line></svg>
                                        </span>
                                    </div>
                                    至　
                                    @if ((DataType)type != DataType.EffectiveStorage)
                                    {
                                        @*<h4 class="sub-title">
                                                結束日期
                                            </h4>
                                            <div class="datePickerGroup">
                                                <div class="input-group">
                                                    <span class="input-group-addon"><i class="far fa-calendar-alt"></i></span>
                                                    @Html.Editor("EndDate", new { htmlAttributes = new { data_toggle = "datepicker", @id = "EndDate", @class = "form-control", @autocomplete = "off", @placeholder = "結束日期" } })
                                                </div>
                                            </div>*@
                                        <div class="input-icon">
                                            <input class="form-control" placeholder="Select a date" id="EndDate">
                                            <span class="input-icon-addon">
                                                <!-- Download SVG icon from http://tabler-icons.io/i/calendar -->
                                                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><rect x="4" y="5" width="16" height="16" rx="2"></rect><line x1="16" y1="3" x2="16" y2="7"></line><line x1="8" y1="3" x2="8" y2="7"></line><line x1="4" y1="11" x2="20" y2="11"></line><line x1="11" y1="15" x2="12" y2="15"></line><line x1="12" y1="15" x2="12" y2="18"></line></svg>
                                            </span>
                                        </div>
                                    }
                                    @*<div class="Query-Part">
                                            <div id="BtnQuery" class="btn btn-primary pull-right" style=" float: right;">查詢</div>
                                        </div>*@
                                </div>
                            </div>
                            <div class="col-12 col-xl-2 ">
                                <div class="form-selectgroup">
                                    <label class="form-selectgroup-item">
                                        <input id="BtnQuery" type="button" name="icons" value="home" class="form-selectgroup-input" checked="">
                                        <span class="form-selectgroup-label">
                                            查詢
                                        </span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--圖表-->
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">


                        <div class="">
                            <div class="chart-Part m-b-30 ">
                                <div class="echarts" style="width: 100%;height:400px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--表格-->
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">


                        <div class="" style="width:90%; margin:auto;">
                            <table id="datatable"></table>
                        </div>
                    </div>
                </div>
            </div>

        </div>

    </div>
</div>
<div id="setting-block" class="card" style="font-family: 微軟正黑體 ;display:none;">
    <div class="card-block option-part">
        <div id="DateTimeSelectionPart" class="option">
            @if ((DataType)type != DataType.EffectiveStorage)
            {
                <div class="cbk-elem">
                    <input checked="" class="inp-cbx" id="DateTimeSelect" type="radio" name="QuerySelect" style="display: none;" value="IrrgPlanData" label="自行設定">
                    <label class="cbx" for="DateTimeSelect">
                        <span>
                            <svg width="12px" height="10px" viewBox="0 0 12 10">
                                <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                            </svg>
                        </span>
                    </label>
                </div>
            }
            <h4 class="sub-title">
                @((DataType)type == DataType.EffectiveStorage ? "選擇日期" : "開始日期")
            </h4>
            <div class="datePickerGroup">
                <div class="input-group">
                    <span class="input-group-addon"><i class="far fa-calendar-alt"></i></span>
                    @Html.Editor("StartDate", new { htmlAttributes = new { data_toggle = "datepicker", @id = "StartDate", @class = "form-control", @autocomplete = "off", @placeholder = ((DataType)type == DataType.EffectiveStorage ? "選擇日期" : "開始日期") } })
                </div>
            </div>
            @if ((DataType)type != DataType.EffectiveStorage)
            {
                <h4 class="sub-title">
                    結束日期
                </h4>
                <div class="datePickerGroup">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="far fa-calendar-alt"></i></span>
                        @Html.Editor("EndDate", new { htmlAttributes = new { data_toggle = "datepicker", @id = "EndDate", @class = "form-control", @autocomplete = "off", @placeholder = "結束日期" } })
                    </div>
                </div>
            }
            <div class="Query-Part">
                <div id="BtnQuery" class="btn btn-primary pull-right" style=" float: right;">查詢</div>
            </div>
        </div>

        @*<div class="chart-Part m-b-30 ">
                <div class="echarts" style="width: 100%;height:400px;"></div>
            </div>*@
        @*<table id="datatable" class="rwd-table"></table>*@
    </div>
</div>



@section Scripts {
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js" type="text/javascript"></script>
    <script type="text/javascript" src=" https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.26.0/moment.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.16.0/dist/locale/bootstrap-table-zh-TW.min.js"></script>
    @*<script src="~/JSLib/datepicker-master/datepicker.min.js"></script>*@
    <script src="~/JSLib/datepicker-master/ROCdatepicker.js?@DateTime.Now.Ticks"></script>
    @*<script src="~/JSLib/datepicker-master/datepicker.js"></script>*@
    <script src="~/JSLib/datepicker-master/datepicker.zh-CN.js?@DateTime.Now.Ticks"></script>
    <script src="~/JSLib/LINQ/JSLINQ.js"></script>
    <script src="~/JSLib/LINQ/linq.min.js"></script>
    <script src="~/JSLib/echart/echarts.min.js"></script>
    <script src="~/JSLib/echart/echarts-theme.js"></script>
    @*<script src="~/Scripts/MyTool/MyDateTool.js"></script>*@
    <script src="~/Scripts/MyTool/MyDataTool.js?@DateTime.Now.Ticks"></script>
    <script src="~/Scripts/MyTool/MyPopoverTool.js?@DateTime.Now.Ticks"></script>
    <script src="~/Scripts/Ajax/ReservoirAjax.js?@DateTime.Now.Ticks"></script>
    <script src="~/Scripts/View/Reservoir/ChartBuilderClass.js?@DateTime.Now.Ticks"></script>
    <script src="~/Scripts/View/Reservoir/DataTable.js?@DateTime.Now.Ticks"></script>

    <script>
        var ajax_src = {
            GetHistoryReservoirDataRank: "@Url.Action("GetHistoryReservoirDataRank", "Reservoir")",
            GetReservoirRuleDay: "@Url.Action("GetReservoirRuleDay", "Reservoir")",
            GetReservoirDataAverage: "@Url.Action("GetReservoirDataAverage", "Reservoir")",
            GetHistoryReservoirTimeSeriesData: "@Url.Action("GetHistoryReservoirTimeSeriesData", "Reservoir")",
            GetReservoirRuleTimeSeriesData: "@Url.Action("GetReservoirRuleTimeSeriesData", "Reservoir")",
            GetPiValueTimeSeriesData: "@Url.Action("GetPiValueTimeSeriesData", "Reservoir")",
        }
        let datatype = @type;
        //$('#TenDaysSelectionPart #StartDate').popover({
        //    animation: false,
        //    html: true,
        //    sanitize: false,
        //    placement: 'bottom',
        //    trigger: 'click',
        //    content: '<button type="button" id="button-image" class="btn btn-primary"><i class="mdi mdi-edit">1</i></button> <br><button type="button" id="button-clear" class="btn btn-danger"><i class="mdi mdi-trash-can-outline">2</i></button>',
        //})
        let mydatetool = new MyDateTool();
        let mypopovertool = new MyPopoverTool(mydatetool.GetPopoverMonthTxtValArry(3, 4));
        let option = {
            title:'月份',
            animation: false,
            html: true,
            sanitize: false,
            placement: 'bottom',
            trigger: 'click',
            content: mypopovertool.CreateContenHtml(),
        }
        mypopovertool.popover('#MonthSelectionPart #StartDate', option, 'MonthSelectionPart-popover')

        let mypopovertool2 = new MyPopoverTool(mydatetool.GetPopoverTenDaysTxtValArry(3, 4, 3));
        let option2 = {
            title: '旬期',
            animation: false,
            html: true,
            sanitize: false,
            placement: 'bottom',
            trigger: 'click',
            content: mypopovertool2.CreateContenHtml(),
        }
        mypopovertool2.popover('#TenDaysSelectionPart #StartDate', option2, 'TenDaysSelectionPart-popover')

    </script>
}